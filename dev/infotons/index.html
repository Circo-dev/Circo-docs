<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Infoton Optimization · Circo</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Circo logo"/></a><div class="docs-package-name"><span class="docs-autofit">Circo</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introducing Circo</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../showcase/">Showcase</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>Infoton Optimization</a></li><li><a class="tocitem" href="../plugindev/">Plugin development</a></li><li><a class="tocitem" href="../reference/">Reference</a></li><li><a class="tocitem" href="../troubleshooting/">Troubleshooting</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Infoton Optimization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Infoton Optimization</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Circo-dev/Circo/blob/master/docs/src/infotons.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Infoton-Optimization"><a class="docs-heading-anchor" href="#Infoton-Optimization">Infoton Optimization</a><a id="Infoton-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Infoton-Optimization" title="Permalink"></a></h1><h4 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h4><p>An old issue of distributed systems comes from the layered cost and latency structure of communication: Networks are slow and bandwidth-limited, whereas inter-thread communication is much faster, but still slow compared to in-thread data passing. Thus communication is often the performance bottleneck that limits scalability and needs to be optimized.</p><p>Infoton optimization tries to minimize communication by using a physics-inspired model. It is essentially a decentralized, scalable version of force-directed graph drawing, aka &quot;spring layout&quot; <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>.</p><h4 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h4><p>Infoton optimization is executed in a &quot;3D Euclidean&quot; space, where actors<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> and schedulers (threads that execute actor code) are embedded. The central idea is that actors move close to their communication partners in the Euclidean space, while distance between them approximates communication costs. This way the communication cost is minimized.</p><p>To approximate communication overhead with actor distance:</p><ol><li><p>Schedulers are also embedded in the space, in a way that their distance represents communication overhead between them. This can be done either by static positioning or the use of network coordinates.</p></li><li><p>Actors are migrated to the nearest scheduler.</p></li></ol><p>To move communicating actors close to each other:</p><ol><li><p>A so-called infoton, a force-carrying particle is attached to every message passed between actors. It is a small structure that holds the position of the source actor and a scalar &quot;energy&quot;.</p></li><li><p>When the message arrives at its destination actor, the infoton that is attached to it acts on that actor, pulling it towards the source of the message.</p></li></ol><p>This would result in all the actors concentrating around a single point, so we need at least one another force to spread the actors in the segment of the space which is &quot;covered&quot; with schedulers. For this:</p><ol><li><p>When a message arrives, the scheduler that executes the target actor creates a second infoton. The source of this infoton is the scheduler itself.</p></li><li><p>This infoton either pulls or pushes the actor toward or away from the scheduler, depending on the &quot;load&quot; of the scheduler. The pulling/pushing behavior of the infoton is called its sign, and it is implemented as the sign of its energy field.</p></li></ol><h4 id="Sample-images"><a class="docs-heading-anchor" href="#Sample-images">Sample images</a><a id="Sample-images-1"></a><a class="docs-heading-anchor-permalink" href="#Sample-images" title="Permalink"></a></h4><p><img src="../assets/infoton/sample1.png" alt/> <img src="../assets/infoton/sample2.png" alt/> <img src="../assets/infoton/sample3.png" alt/> <img src="../assets/infoton/sample4.png" alt/></p><h4 id="Notes"><a class="docs-heading-anchor" href="#Notes">Notes</a><a id="Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Notes" title="Permalink"></a></h4><ol><li><p>The limits and applicability of this algorithm is not yet explored, implementation details are not fixed. Quoted terms in the description mark areas of uncertainty.</p></li><li><p>The cost of this optimization is a small, constant overhead on every message sent, plus the overhead of actor migration. Actor count is irrelevant, as inactive actors are not optimized.</p></li><li><p>Actors cannot collide in this model. They may be positioned at the exact same place.</p></li><li><p>However, infotons attached to messages also can have a negative sign to push away the destination actor instead of pulling it. This can be used to introduce domain-specific knowledge or special requirements into the model. E.g. If multiple copies of a piece of data exist in the system for failure tolerance,  the copies can preiodically check the liveness of each other while also spread as a result.</p></li></ol><h4 id="Sample-codes-(Julia)"><a class="docs-heading-anchor" href="#Sample-codes-(Julia)">Sample codes (Julia)</a><a id="Sample-codes-(Julia)-1"></a><a class="docs-heading-anchor-permalink" href="#Sample-codes-(Julia)" title="Permalink"></a></h4><p>This is the current default implementation in Circo of how an infoton acts on the target actor. In this version pulling forces are not applied if the distance between the source and the target is too small. This trick seems to lead to better results in some cases. It introduces a parameter called <code>TARGET_DISTANCE</code>, and it can be thought of as a rudimentary approximation of a separate force that pushes actors away when they are too close.</p><pre><code class="language-julia">Pos = VecE3{Float32} # 3D coordinates

struct Infoton
    sourcepos::Pos
    energy::Float32 # The sign of this field is called the sign of the Infoton
    Infoton(sourcepos::Pos, energy::Real = 1) = new(sourcepos, Float32(energy))
end

const TARGET_DISTANCE = 15.0

function apply_infoton(targetactor::AbstractActor, infoton::Infoton)
    diff = infoton.sourcepos - targetactor.core.pos
    difflen = norm(diff)
    energy = infoton.energy
    if energy &gt; 0 &amp;&amp; difflen &lt; TARGET_DISTANCE
        return nothing
    end
    targetactor.core.pos += diff / difflen * energy
    return nothing
end</code></pre><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>For simplicity, here I use the actor model to describe the algorithm, but it can be adapted to other concurrency models.</li><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://en.wikipedia.org/wiki/Force-directed_graph_drawing">Force-directed graph drawing in Wikipedia</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../plugindev/">Plugin development »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 12 October 2020 07:38">Monday 12 October 2020</span>. Using Julia version 1.5.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
